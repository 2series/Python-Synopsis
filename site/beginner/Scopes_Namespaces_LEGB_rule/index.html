



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Python Study Guide">
      
      
      
        <meta name="author" content="Goga Patarkatsishvili">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-0.17.2, mkdocs-material-2.5.0">
    
    
      
        <title>Scopes, Namespaces and LEGB Rule - Python Synopsis</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.2a88008a.css">
      
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
    
  </head>
  
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="Python Synopsis" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Python Synopsis
              </span>
              <span class="md-header-nav__topic">
                Scopes, Namespaces and LEGB Rule
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://ent1c3d.github.io/Python-Synopsis/site/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      ent1c3d/Python-Synopsis
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </span>
    Python Synopsis
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://ent1c3d.github.io/Python-Synopsis/site/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      ent1c3d/Python-Synopsis
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      Beginner
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Beginner
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../Python_Programming_Lanuage/" title="The Python Programming Language, Implementation and Adventages" class="md-nav__link">
      The Python Programming Language, Implementation and Adventages
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Python_Installation/" title="Python Installation" class="md-nav__link">
      Python Installation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Start_Coding_With_Python/" title="Start Coding With Python" class="md-nav__link">
      Start Coding With Python
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Data_Types_In_Python_3/" title="Data Types in Python 3" class="md-nav__link">
      Data Types in Python 3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Variables_And_Assignment/" title="Variables and Assignment" class="md-nav__link">
      Variables and Assignment
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Conditions/" title="Conditions" class="md-nav__link">
      Conditions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../For_Loop/" title="For Loop" class="md-nav__link">
      For Loop
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Functions/" title="Functions" class="md-nav__link">
      Functions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Scopes/" title="Scope" class="md-nav__link">
      Scope
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Scopes, Namespaces and LEGB Rule
      </label>
    
    <a href="./" title="Scopes, Namespaces and LEGB Rule" class="md-nav__link md-nav__link--active">
      Scopes, Namespaces and LEGB Rule
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction-to-namespaces-and-scopes" title="Introduction to namespaces and scopes" class="md-nav__link">
    Introduction to namespaces and scopes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#namespaces" title="Namespaces" class="md-nav__link">
    Namespaces
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scope" title="Scope" class="md-nav__link">
    Scope
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tip" title="Tip:" class="md-nav__link">
    Tip:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scope-resolution-for-variable-names-via-the-legb-rule" title="Scope resolution for variable names via the LEGB rule." class="md-nav__link">
    Scope resolution for variable names via the LEGB rule.
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-lg-local-and-global-scopes" title="1. LG - Local and Global scopes" class="md-nav__link">
    1. LG - Local and Global scopes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-leg-local-enclosed-and-global-scope" title="2. LEG - Local, Enclosed, and Global scope" class="md-nav__link">
    2. LEG - Local, Enclosed, and Global scope
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-legb-local-enclosed-global-built-in" title="3. LEGB - Local, Enclosed, Global, Built-in" class="md-nav__link">
    3. LEGB - Local, Enclosed, Global, Built-in
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#self-assessment-exercise" title="Self-assessment exercise" class="md-nav__link">
    Self-assessment exercise
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" title="Conclusion" class="md-nav__link">
    Conclusion
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Advanced
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Advanced
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../advanced/Context_Managers/" title="Context Managers" class="md-nav__link">
      Context Managers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../advanced/Python_Metaclasses/" title="Python Metaclasses" class="md-nav__link">
      Python Metaclasses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../advanced/Python_Magic_Methods/" title="Python Magic Methods" class="md-nav__link">
      Python Magic Methods
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../About/" title="About" class="md-nav__link">
      About
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction-to-namespaces-and-scopes" title="Introduction to namespaces and scopes" class="md-nav__link">
    Introduction to namespaces and scopes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#namespaces" title="Namespaces" class="md-nav__link">
    Namespaces
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scope" title="Scope" class="md-nav__link">
    Scope
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tip" title="Tip:" class="md-nav__link">
    Tip:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scope-resolution-for-variable-names-via-the-legb-rule" title="Scope resolution for variable names via the LEGB rule." class="md-nav__link">
    Scope resolution for variable names via the LEGB rule.
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-lg-local-and-global-scopes" title="1. LG - Local and Global scopes" class="md-nav__link">
    1. LG - Local and Global scopes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-leg-local-enclosed-and-global-scope" title="2. LEG - Local, Enclosed, and Global scope" class="md-nav__link">
    2. LEG - Local, Enclosed, and Global scope
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-legb-local-enclosed-global-built-in" title="3. LEGB - Local, Enclosed, Global, Built-in" class="md-nav__link">
    3. LEGB - Local, Enclosed, Global, Built-in
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#self-assessment-exercise" title="Self-assessment exercise" class="md-nav__link">
    Self-assessment exercise
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" title="Conclusion" class="md-nav__link">
    Conclusion
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="a-beginners-guide-to-pythons-namespaces-scope-resolution-and-the-legb-rule">A Beginner's Guide to Python's Namespaces, Scope Resolution, and the LEGB Rule</h1>
<h2 id="introduction-to-namespaces-and-scopes">Introduction to namespaces and scopes</h2>
<h2 id="namespaces">Namespaces</h2>
<p>Roughly speaking, namespaces are just containers for mapping names to objects. As you might have already heard, everything in Python - literals, lists, dictionaries, functions, classes, etc. - is an object.
Such a “name-to-object” mapping allows us to access an object by a name that we’ve assigned to it. E.g., if we make a simple string assignment via a_string = "Hello string", we created a reference to the "Hello string" object, and henceforth we can access via its variable name a_string.</p>
<p>We can picture a namespace as a Python dictionary structure, where the dictionary keys represent the names and the dictionary values the object itself (and this is also how namespaces are currently implemented in Python), e.g.,</p>
<div class="codehilite"><pre><span></span><span class="n">a_namespace</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name_a&#39;</span><span class="p">:</span><span class="n">object_1</span><span class="p">,</span> <span class="s1">&#39;name_b&#39;</span><span class="p">:</span><span class="n">object_2</span><span class="p">,</span> <span class="o">...</span> <span class="p">}</span>
</pre></div>


<p>Now, the tricky part is that we have multiple independent namespaces in Python, and names can be reused for different namespaces (only the objects are unique, for example:</p>
<div class="codehilite"><pre><span></span><span class="n">a_namespace</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name_a&#39;</span><span class="p">:</span><span class="n">object_1</span><span class="p">,</span> <span class="s1">&#39;name_b&#39;</span><span class="p">:</span><span class="n">object_2</span><span class="p">,</span> <span class="o">...</span><span class="p">}</span>
<span class="n">b_namespace</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name_a&#39;</span><span class="p">:</span><span class="n">object_3</span><span class="p">,</span> <span class="s1">&#39;name_b&#39;</span><span class="p">:</span><span class="n">object_4</span><span class="p">,</span> <span class="o">...</span><span class="p">}</span>
</pre></div>


<p>For example, everytime we call a for-loop or define a function, it will create its own namespace. Namespaces also have different levels of hierarchy (the so-called “scope”), which we will discuss in more detail in the next section.</p>
<h2 id="scope">Scope</h2>
<p>In the section above, we have learned that namespaces can exist independently from each other and that they are structured in a certain hierarchy, which brings us to the concept of “scope”. The “scope” in Python defines the “hierarchy level” in which we search namespaces for certain “name-to-object” mappings.
For example, let us consider the following code:  </p>
<div class="codehilite"><pre><span></span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>

<span class="k">def</span> <span class="nf">foo</span><span class="p">():</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="k">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;in foo()&#39;</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;global&#39;</span><span class="p">)</span>

<span class="n">foo</span><span class="p">()</span>

<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">output:</span>
<span class="sd">1 global</span>
<span class="sd">5 in foo()</span>
<span class="sd">&#39;&#39;&#39;</span>
</pre></div>


<p>Here, we just defined the variable name i twice, once on the foo function.
- foo_namespace = {'i':object_3, ...}
- global_namespace = {'i':object_1, 'name_b':object_2, ...}</p>
<p>So, how does Python know which namespace it has to search if we want to print the value of the variable i? This is where Python’s LEGB-rule comes into play, which we will discuss in the next section.</p>
<h4 id="tip">Tip:</h4>
<p>If we want to print out the dictionary mapping of the global and local variables, we can use the the functions global() and local()</p>
<div class="codehilite"><pre><span></span><span class="c1">#print(globals()) # prints global namespace</span>
<span class="c1">#print(locals()) # prints local namespace</span>

<span class="n">glob</span> <span class="o">=</span> <span class="mi">1</span>

<span class="k">def</span> <span class="nf">foo</span><span class="p">():</span>
    <span class="n">loc</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;loc in foo():&#39;</span><span class="p">,</span> <span class="s1">&#39;loc&#39;</span> <span class="ow">in</span> <span class="nb">locals</span><span class="p">())</span>

<span class="n">foo</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;loc in global:&#39;</span><span class="p">,</span> <span class="s1">&#39;loc&#39;</span> <span class="ow">in</span> <span class="nb">globals</span><span class="p">())</span>    
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;glob in global:&#39;</span><span class="p">,</span> <span class="s1">&#39;foo&#39;</span> <span class="ow">in</span> <span class="nb">globals</span><span class="p">())</span>

<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">loc in foo(): True</span>
<span class="sd">loc in global: False</span>
<span class="sd">glob in global: True</span>
<span class="sd">&#39;&#39;&#39;</span>
</pre></div>


<h3 id="scope-resolution-for-variable-names-via-the-legb-rule">Scope resolution for variable names via the LEGB rule.</h3>
<p>We have seen that multiple namespaces can exist independently from each other and that they can contain the same variable names on different hierachy levels. The “scope” defines on which hierarchy level Python searches for a particular “variable name” for its associated object. Now, the next question is: “In which order does Python search the different levels of namespaces before it finds the name-to-object’ mapping?”
To answer is: It uses the LEGB-rule, which stands for</p>
<p><code>Local -&gt; Enclosed -&gt; Global -&gt; Built-in,</code></p>
<p>where the arrows should denote the direction of the namespace-hierarchy search order.</p>
<ul>
<li>Local can be inside a function or class method, for example.</li>
<li>Enclosed can be its enclosing function, e.g., if a function is wrapped inside another function.</li>
<li>Global refers to the uppermost level of the executing script itself, and</li>
<li>Built-in are special names that Python reserves for itself.</li>
</ul>
<p>So, if a particular name:object mapping cannot be found in the local namespaces, the namespaces of the enclosed scope are being searched next. If the search in the enclosed scope is unsuccessful, too, Python moves on to the global namespace, and eventually, it will search the built-in namespace (side note: if a name cannot found in any of the namespaces, a NameError will is raised).</p>
<p>Namespaces can also be further nested, for example if we import modules, or if we are defining new classes. In those cases we have to use prefixes to access those nested namespaces. Let me illustrate this concept in the following code block:</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">scipy</span>

<span class="k">print</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="s1">&#39;from the math module&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="s1">&#39;from the numpy package&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="s1">&#39;from the scipy package&#39;</span><span class="p">)</span>


<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">3.141592653589793 from the math module</span>
<span class="sd">3.141592653589793 from the numpy package</span>
<span class="sd">3.141592653589793 from the scipy package</span>
<span class="sd">&#39;&#39;&#39;</span>
</pre></div>


<p>(This is also why we have to be careful if we import modules via “from a_module import *”, since it loads the variable names into the global namespace and could potentially overwrite already existing variable names)</p>
<p><img alt="a2box." src="../../images/scope_resolution_1.png" /></p>
<h2 id="1-lg-local-and-global-scopes">1. LG - Local and Global scopes</h2>
<p>As a warm-up exercise, let us first forget about the enclosed (E) and built-in (B) scopes in the LEGB rule and only take a look at LG - the local and global scopes.
What does the following code print?</p>
<div class="codehilite"><pre><span></span><span class="n">a_var</span> <span class="o">=</span> <span class="s1">&#39;global variable&#39;</span>

<span class="k">def</span> <span class="nf">a_func</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="n">a_var</span><span class="p">,</span> <span class="s1">&#39;[ a_var inside a_func() ]&#39;</span><span class="p">)</span>

<span class="n">a_func</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">a_var</span><span class="p">,</span> <span class="s1">&#39;[ a_var outside a_func() ]&#39;</span><span class="p">)</span>

<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">answer:</span>
<span class="sd">global value [ a_var inside a_func() ]  </span>
<span class="sd">global value [ a_var outside a_func() ]</span>
<span class="sd">&#39;&#39;&#39;</span>
</pre></div>


<p>Here is why:</p>
<p>We call a_func() first, which is supposed to print the value of a_var. According to the LEGB rule, the function will first look in its own local scope (L) if a_var is defined there. Since a_func() does not define its own a_var, it will look one-level above in the global scope (G) in which a_var has been defined previously. </p>
<p>Example 1.2
Now, let us define the variable a_var in the global and the local scope.
Can you guess what the following code will produce?</p>
<div class="codehilite"><pre><span></span><span class="n">a_var</span> <span class="o">=</span> <span class="s1">&#39;global value&#39;</span>

<span class="k">def</span> <span class="nf">a_func</span><span class="p">():</span>
    <span class="n">a_var</span> <span class="o">=</span> <span class="s1">&#39;local value&#39;</span>
    <span class="k">print</span><span class="p">(</span><span class="n">a_var</span><span class="p">,</span> <span class="s1">&#39;[ a_var inside a_func() ]&#39;</span><span class="p">)</span>

<span class="n">a_func</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">a_var</span><span class="p">,</span> <span class="s1">&#39;[ a_var outside a_func() ]&#39;</span><span class="p">)</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">answer:</span>
<span class="sd">local value [ a_var inside a_func() ]</span>
<span class="sd">global value [ a_var outside a_func() ]</span>
<span class="sd">&#39;&#39;&#39;</span>
</pre></div>


<p>Here is why:</p>
<p>When we call a_func(), it will first look in its local scope (L) for a_var, since a_var is defined in the local scope of a_func, its assigned value local variable is printed. Note that this doesn’t affect the global variable, which is in a different scope.</p>
<p>However, it is also possible to modify the global by, e.g., re-assigning a new value to it if we use the global keyword as the following example will illustrate:</p>
<div class="codehilite"><pre><span></span><span class="n">a_var</span> <span class="o">=</span> <span class="s1">&#39;global value&#39;</span>

<span class="k">def</span> <span class="nf">a_func</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">a_var</span>
    <span class="n">a_var</span> <span class="o">=</span> <span class="s1">&#39;local value&#39;</span>
    <span class="k">print</span><span class="p">(</span><span class="n">a_var</span><span class="p">,</span> <span class="s1">&#39;[ a_var inside a_func() ]&#39;</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">a_var</span><span class="p">,</span> <span class="s1">&#39;[ a_var outside a_func() ]&#39;</span><span class="p">)</span>
<span class="n">a_func</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">a_var</span><span class="p">,</span> <span class="s1">&#39;[ a_var outside a_func() ]&#39;</span><span class="p">)</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">output:</span>
<span class="sd">global value [ a_var outside a_func() ]</span>
<span class="sd">local value [ a_var inside a_func() ]</span>
<span class="sd">local value [ a_var outside a_func() ]</span>
<span class="sd">&#39;&#39;&#39;</span>
</pre></div>


<p>But we have to be careful about the order: it is easy to raise an UnboundLocalError if we don’t explicitly tell Python that we want to use the global scope and try to modify a variable’s value (remember, the right side of an assignment operation is executed first):</p>
<div class="codehilite"><pre><span></span><span class="n">a_var</span> <span class="o">=</span> <span class="mi">1</span>

<span class="k">def</span> <span class="nf">a_func</span><span class="p">():</span>
    <span class="n">a_var</span> <span class="o">=</span> <span class="n">a_var</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">print</span><span class="p">(</span><span class="n">a_var</span><span class="p">,</span> <span class="s1">&#39;[ a_var inside a_func() ]&#39;</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">a_var</span><span class="p">,</span> <span class="s1">&#39;[ a_var outside a_func() ]&#39;</span><span class="p">)</span>
<span class="n">a_func</span><span class="p">()</span>

<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">output:</span>
<span class="sd">---------------------------------------------------------------------------</span>
<span class="sd">UnboundLocalError                         Traceback (most recent call last)</span>
<span class="sd">&#39;&#39;&#39;</span>
</pre></div>


<h2 id="2-leg-local-enclosed-and-global-scope">2. LEG - Local, Enclosed, and Global scope</h2>
<p>Now, let us introduce the concept of the enclosed (E) scope. Following the order “Local -&gt; Enclosed -&gt; Global”, can you guess what the following code will print?</p>
<p>Example 2.1</p>
<div class="codehilite"><pre><span></span><span class="n">a_var</span> <span class="o">=</span> <span class="s1">&#39;global value&#39;</span>

<span class="k">def</span> <span class="nf">outer</span><span class="p">():</span>
    <span class="n">a_var</span> <span class="o">=</span> <span class="s1">&#39;enclosed value&#39;</span>

    <span class="k">def</span> <span class="nf">inner</span><span class="p">():</span>
        <span class="n">a_var</span> <span class="o">=</span> <span class="s1">&#39;local value&#39;</span>
        <span class="k">print</span><span class="p">(</span><span class="n">a_var</span><span class="p">)</span>

    <span class="n">inner</span><span class="p">()</span>

<span class="n">outer</span><span class="p">()</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">output:</span>
<span class="sd">local value</span>
<span class="sd">&#39;&#39;&#39;</span>
</pre></div>


<p>Here is why:</p>
<p>Let us quickly recapitulate what we just did: We called outer(), which defined the variable a_var locally (next to an existing a_var in the global scope). Next, the outer() function called inner(), which in turn defined a variable with of name a_var as well. The print() function inside inner() searched in the local scope first (L-&gt;E) before it went up in the scope hierarchy, and therefore it printed the value that was assigned in the local scope.</p>
<p>Similar to the concept of the global keyword, which we have seen in the section above, we can use the keyword nonlocal inside the inner function to explicitly access a variable from the outer (enclosed) scope in order to modify its value.
Note that the nonlocal keyword was added in Python 3.x and is not implemented in Python 2.x (yet).</p>
<div class="codehilite"><pre><span></span><span class="n">a_var</span> <span class="o">=</span> <span class="s1">&#39;global value&#39;</span>

<span class="k">def</span> <span class="nf">outer</span><span class="p">():</span>
       <span class="n">a_var</span> <span class="o">=</span> <span class="s1">&#39;local value&#39;</span>
       <span class="k">print</span><span class="p">(</span><span class="s1">&#39;outer before:&#39;</span><span class="p">,</span> <span class="n">a_var</span><span class="p">)</span>
       <span class="k">def</span> <span class="nf">inner</span><span class="p">():</span>
           <span class="n">nonlocal</span> <span class="n">a_var</span>
           <span class="n">a_var</span> <span class="o">=</span> <span class="s1">&#39;inner value&#39;</span>
           <span class="k">print</span><span class="p">(</span><span class="s1">&#39;in inner():&#39;</span><span class="p">,</span> <span class="n">a_var</span><span class="p">)</span>
       <span class="n">inner</span><span class="p">()</span>
       <span class="k">print</span><span class="p">(</span><span class="s2">&quot;outer after:&quot;</span><span class="p">,</span> <span class="n">a_var</span><span class="p">)</span>
<span class="n">outer</span><span class="p">()</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">output:</span>
<span class="sd">outer before: local value</span>
<span class="sd">in inner(): inner value</span>
<span class="sd">outer after: inner value</span>
<span class="sd">&#39;&#39;&#39;</span>
</pre></div>


<h2 id="3-legb-local-enclosed-global-built-in">3. LEGB - Local, Enclosed, Global, Built-in</h2>
<p>To wrap up the LEGB rule, let us come to the built-in scope. Here, we will define our “own” length-function, which happens to bear the same name as the in-built len() function. What outcome do you excpect if we’d execute the following code?</p>
<div class="codehilite"><pre><span></span><span class="n">a_var</span> <span class="o">=</span> <span class="s1">&#39;global variable&#39;</span>

<span class="k">def</span> <span class="nf">len</span><span class="p">(</span><span class="n">in_var</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;called my len() function&#39;</span><span class="p">)</span>
    <span class="n">l</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">in_var</span><span class="p">:</span>
        <span class="n">l</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">l</span>

<span class="k">def</span> <span class="nf">a_func</span><span class="p">(</span><span class="n">in_var</span><span class="p">):</span>
    <span class="n">len_in_var</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">in_var</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Input variable is of length&#39;</span><span class="p">,</span> <span class="n">len_in_var</span><span class="p">)</span>

<span class="n">a_func</span><span class="p">(</span><span class="s1">&#39;Hello, World!&#39;</span><span class="p">)</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">output:</span>
<span class="sd">called my len() function</span>
<span class="sd">Input variable is of length 13</span>
<span class="sd">&#39;&#39;&#39;</span>
</pre></div>


<p>Here is why:</p>
<p>Since the exact same names can be used to map names to different objects - as long as the names are in different name spaces - there is no problem of reusing the name len to define our own length function (this is just for demonstration pruposes, it is NOT recommended). As we go up in Python’s L -&gt; E -&gt; G -&gt; B hierarchy, the function a_func() finds len() already in the global scope (G) first before it attempts to search the built-in (B) namespace.</p>
<h3 id="self-assessment-exercise">Self-assessment exercise</h3>
<p>Now, after we went through a couple of exercises, let us quickly check where we are. So, one more time: What would the following code print out?</p>
<div class="codehilite"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="s1">&#39;global&#39;</span>

<span class="k">def</span> <span class="nf">outer</span><span class="p">():</span>

    <span class="k">def</span> <span class="nf">len</span><span class="p">(</span><span class="n">in_var</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;called my len() function: &#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">l</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">in_var</span><span class="p">:</span>
            <span class="n">l</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">l</span>

    <span class="n">a</span> <span class="o">=</span> <span class="s1">&#39;local&#39;</span>

    <span class="k">def</span> <span class="nf">inner</span><span class="p">():</span>
        <span class="k">global</span> <span class="nb">len</span>
        <span class="n">nonlocal</span> <span class="n">a</span>
        <span class="n">a</span> <span class="o">+=</span> <span class="s1">&#39; variable&#39;</span>
    <span class="n">inner</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;a is&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>


<span class="n">outer</span><span class="p">()</span>

<span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;a is&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>


<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">output:</span>
<span class="sd">a is local variable</span>
<span class="sd">called my len() function: 14</span>
<span class="sd">6</span>
<span class="sd">a is global</span>
<span class="sd">&#39;&#39;&#39;</span>
</pre></div>


<h2 id="conclusion">Conclusion</h2>
<p>I hope this short tutorial was helpful to understand the basic concept of Python’s scope resolution order using the LEGB rule. I want to encourage you (as a little self-assessment exercise) to look at the code snippets again tomorrow and check if you can correctly predict all their outcomes.</p>
<p>A rule of thumb</p>
<p>In practice, it is usually a bad idea to modify global variables inside the function scope, since it often be the cause of confusion and weird errors that are hard to debug.
If you want to modify a global variable via a function, it is recommended to pass it as an argument and reassign the return-value.
For example:</p>
<div class="codehilite"><pre><span></span><span class="n">a_var</span> <span class="o">=</span> <span class="mi">2</span>

<span class="k">def</span> <span class="nf">a_func</span><span class="p">(</span><span class="n">some_var</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">2</span><span class="o">**</span><span class="mi">3</span>

<span class="n">a_var</span> <span class="o">=</span> <span class="n">a_func</span><span class="p">(</span><span class="n">a_var</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">a_var</span><span class="p">)</span>

<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">output:</span>
<span class="sd">8</span>
<span class="sd">&#39;&#39;&#39;</span>
</pre></div>


<blockquote>
<p><strong>Source:</strong> <br />
<i class="fa fa-link"></i> http://sebastianraschka.com/Articles/2014_python_scope_and_namespaces.html</p>
</blockquote>
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../Scopes/" title="Scope" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Scope
              </span>
            </div>
          </a>
        
        
          <a href="../../advanced/Context_Managers/" title="Context Managers" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Context Managers
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2017 Goga Patarkatsishvili
          </div>
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="https://github.com/ent1c3d" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://www.linkedin.com/in/ent1c3d/" class="md-footer-social__link fa fa-linkedin"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.ce2ab4bf.js"></script>
      
      <script>app.initialize({version:"0.17.2",url:{base:"../.."}})</script>
      
    
    
      
    
  </body>
</html>